'use strict';const woostifyAutocompleteSearchDelay=function(){let a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),woostifyAutocompleteRender=function(a="post_type",b="product",c){let d=c.el.querySelector(".wty-autocomplete");if(!d||!c.getControlValue().length)return;let e=c.el.querySelector(".elementor-control-title"),f=d.querySelector(".wty-autocomplete-selection"),g=f.querySelector(".wty-autocomplete-selected"),h={action:g.name,security_nonce:woostify_autocomplete.nonce,selected_id:c.getControlValue(),query:a,value:b};e&&e.insertAdjacentHTML("beforeend","<i class=\"eicon-spinner eicon-animation-spin\"></i>"),h=new URLSearchParams(h).toString();let i=new Request(ajaxurl,{method:"POST",body:h,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(i).then(function(d){return 200===d.status?void d.json().then(function(d){d.success&&d.data&&(f.insertAdjacentHTML("afterbegin",d.data),woostifyAutocomplete(a,b,c))}):void console.log("Status Code: "+d.status)}).catch(function(a){console.log(a)}).finally(function(){if(e){let a=e.querySelector(".eicon-spinner");a&&a.remove()}})},woostifyAutocomplete=function(a="post_type",b="product",c){let d=c.el.querySelector(".wty-autocomplete");if(!d)return;let e=d.querySelector(".wty-autocomplete-selection"),f=e.querySelector(".wty-autocomplete-search"),g=d.querySelector(".wty-autocomplete-dropdown");const h=function(a=!1){let b=e.querySelectorAll(".wty-autocomplete-id"),d=[];return b.forEach(function(a){let b=+a.getAttribute("data-id");!b||d.includes(b)||d.push(b)}),!0===a?d:void c.setValue(d)},i=function(){let a=e.querySelectorAll(".wty-autocomplete-id");a.length&&a.forEach(function(a){let b=a.getAttribute("data-id"),c=a.querySelector(".wty-autocomplete-remove-id");c&&(c.onclick=function(){if(a.parentNode){d.classList.add("active");let c=g.querySelector("[data-id=\""+b+"\"]");c&&c.classList.remove("disabled"),a.remove(),h()}})})};i();const j=function(){let a=g.querySelectorAll(".wty-autocomplete-id");if(a.length)for(let b=0,c=a.length;b<c;b++)a[b].onclick=function(){let a=this,b=a.classList.contains("disabled"),c=a.getAttribute("data-id");if(!b){g.innerHTML="",f.value="",a.classList.add("disabled");let b="<span class=\"wty-autocomplete-id\" data-id=\""+c+"\">"+a.innerHTML+"<i class=\"wty-autocomplete-remove-id eicon-close-circle\"></i></span>";e.insertAdjacentHTML("afterbegin",b),h(),i()}}};f&&f.addEventListener("input",function(){let c=f.value.trim(),d={action:f.name,security_nonce:woostify_autocomplete.nonce,keyword:c,query:a,value:b};d=new URLSearchParams(d).toString();let e=new Request(ajaxurl,{method:"POST",body:d,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});return 1>c.length?void(g.innerHTML=""):void(g.innerHTML="<span class=\"wty-autocomplete-searching\">"+woostify_autocomplete.searching+"</span>",woostifyAutocompleteSearchDelay(function(){fetch(e).then(function(a){return 200===a.status?void a.json().then(function(a){if(a.success){let b=new DOMParser,c=b.parseFromString(a.data,"text/html"),d=c.querySelectorAll(".wty-autocomplete-id");d.length&&d.forEach(function(a){let b=+a.getAttribute("data-id")||"",c=h(!0)||[];c.length&&(c.includes(b)?a.classList.add("disabled"):a.classList.remove("disabled"))}),g.innerHTML=c.body.innerHTML,j()}}):void console.log("Status Code: "+a.status)}).catch(function(a){g.innerHTML="",console.log(a)})},500))})},woostifyAutocompleteData={onReady:function(){let a=this,b=a.model.get("query"),c=b.type,d=b.name;woostifyAutocompleteRender(c,d,a),woostifyAutocomplete(c,d,a)}},woostifyAutocompleteControl=elementor.modules.controls.BaseData.extend(woostifyAutocompleteData);elementor.addControlView("autocomplete",woostifyAutocompleteControl);