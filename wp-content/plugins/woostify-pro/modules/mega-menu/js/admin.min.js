'use strict';var woostifyPrevSiblings=function(a){var b=[],c=a;if(c&&c.previousElementSibling)for(;c=c.previousElementSibling;)b.push(c);return b},woostifyNextSiblings=function(a){var b=[],c=a;if(c&&c.nextElementSibling)for(;c=c.nextElementSibling;)b.push(c);return b},woostifySiblings=function(a){var b=woostifyPrevSiblings(a)||[],c=woostifyNextSiblings(a)||[];return b.concat(c)},woostifyButtonShowPopup=function(){var a=document.querySelectorAll(".menu-item-mega_menu.menu-item-depth-0");a.length&&a.forEach(function(a){var b=a.getAttribute("id"),c=a.querySelector(".edit-menu-item-title"),d=!!c&&c.closest("p.description");d&&b&&(b=b.replace("menu-item-",""),d.insertAdjacentHTML("afterend","<div class=\"description description-wide\"><span class=\"woostify-mega-menu-options-button button\" data-id=\""+b+"\" data-depth=\"0\">"+woostify_admin_mega_menu.button_label+"</span></div>"))})},woostifyIconPicker=function(){var a=document.querySelector(".woostify-icon-picker");if(a){var b=a.querySelector(".woostify-icon-picker-inner"),c=a.querySelectorAll("span"),d=a.querySelector(".woostify-icon-picker-value");c.length&&c.forEach(function(a){a.onclick=function(){var b=woostifySiblings(a),c=a.getAttribute("class");a.classList.contains("selected")?(a.classList.remove("selected"),d.value=""):(a.classList.add("selected"),d.value=c),b&&b.forEach(function(a){a.classList.remove("selected")})}})}},woostifySaveMenuOptions=function(){var a=document.querySelector(".woostify-mega-menu-options-popup"),b=a.getAttribute("data-id"),c=document.querySelector("#menu-item-"+b+" .woostify-mega-menu-options-button"),d=c.getAttribute("data-id"),e=a.querySelector(".save-options");e.onclick=function(){var b=this,c=a.querySelectorAll("[name*=woostify_mega_menu_item_]"),e={};b.classList.add("loading"),b.setAttribute("disabled","disabled"),c.length&&c.forEach(function(a){e[a.name]=a.value});var f=new Request(ajaxurl,{method:"POST",body:"action=woostify_save_menu_options&security_nonce="+woostify_admin_mega_menu.ajax_nonce+"&menu_item_id="+d+"&options="+JSON.stringify(e),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(f).then(function(a){if(200!==a.status)return void console.log("Status Code: "+a.status)}).catch(function(a){console.log(a)}).finally(function(){b.classList.remove("loading"),b.removeAttribute("disabled")})}},woostifyEditMegaMenu=function(){var a=document.querySelectorAll(".woostify-mega-menu-options-button");a.length&&a.forEach(function(a){var b=document.querySelector(".woostify-mega-menu-options-popup"),c=b.querySelector(".woostify-mega-menu-popup-inner"),d=b.querySelector(".woostify-mega-menu-popup-content"),e=b.querySelector(".woostify-mega-menu-editing-label"),f=b.querySelector(".woostify-mega-menu-popup-button-close"),g=a.getAttribute("data-id"),h=a.getAttribute("data-depth"),i=function(){document.documentElement.classList.remove("has-mega-menu-open")};a.onclick=function(){if(!(0<h)){document.documentElement.classList.add("has-mega-menu-open");var a=document.getElementById("menu-item-"+g),j=b.getAttribute("data-id"),k=a?a.querySelector(".menu-item-title").innerHTML:"",l=a?a.querySelector(".item-type").innerHTML:"";if(j!==g){e.innerHTML=e.getAttribute("data-label")+" "+l+": "+k,d.innerHTML="",c.classList.add("loading");var m=new Request(ajaxurl,{method:"POST",body:"action=woostify_render_popup&security_nonce="+woostify_admin_mega_menu.ajax_nonce+"&menu_item_id="+g+"&depth="+h,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(m).then(function(a){return 200===a.status?void a.json().then(function(a){a.success&&(d.innerHTML=a.data,woostifyIconPicker())}):void console.log("Status Code: "+a.status)}).catch(function(a){console.log(a)}).finally(function(){b.setAttribute("data-id",g),c.classList.remove("loading"),woostifySaveMenuOptions(),b.onclick=function(a){var b=a.target.closest(".woostify-mega-menu-popup-inner");b||i()},f.onclick=function(){i()},document.body.addEventListener("keyup",function(a){27===a.keyCode&&i()})})}}}})};document.addEventListener("DOMContentLoaded",function(){woostifyButtonShowPopup(),woostifyEditMegaMenu()});