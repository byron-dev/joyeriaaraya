'use strict';var woostifySearchDelay=function(a){return"undefined"==typeof a&&(a=0),function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),woostifySelectProductPreview=function(a){NProgress.start();var b={action:"woo_builder_select_product_preview",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,selected_id:a};b=new URLSearchParams(b).toString();var c=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:b,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(c).then(function(a){if(200!==a.status)throw console.log("Status Code: "+a.status),a;return a.json()}).then(function(a){!a.success}).catch(function(a){console.log(a)}).finally(function(){"undefined"!=typeof elementor&&elementor.reloadPreview(),NProgress.done()})},woostifyWooBuilderPreview=function(){var a=document.getElementById("elementor-panel-footer-tools");if(a){window.wooBuilderOpen=null;var b=a.querySelector("#elementor-panel-footer-saver-preview");if(b&&woostify_woo_builder_editor.is_product_template){b.setAttribute("id","woostify-tool-preview-button");var c=a.querySelector("#elementor-panel-footer-saver-preview-label");if(c){var d="";d+="<div class=\"woostify-preview-settings-wrap\">",d+="<div class=\"woostify-preview-settings-inner\">",d+="<div class=\"woostify-preview-search\">",d+="<div class=\"woostify-preview-search-result\"></div>",d+="<input class=\"woostify-preview-search-field\" placeholder=\""+woostify_woo_builder_editor.search_placeholder+"\">",d+="</div>",d+="<span class=\"woostify-preview-value\" data-url>"+woostify_woo_builder_editor.select_preview+"</span>",d+="<span class=\"woostify-preview-button\">"+woostify_woo_builder_editor.preview_text+"</span>",d+="</div>",d+="</div>",c.insertAdjacentHTML("afterend",d);var e=0,f=0;c.onclick=function(b){b.preventDefault(),0==f?(f=1,document.body.classList.add("hide-elementor-tooltip"),c.parentNode.classList.add("elementor-open")):(f=0,document.body.classList.remove("hide-elementor-tooltip"),c.parentNode.classList.remove("elementor-open"));var d=a.querySelector(".woostify-preview-settings-wrap"),g=d.querySelector(".woostify-preview-value"),h=d.querySelector(".woostify-preview-search"),i=d.querySelector(".woostify-preview-search-field"),j=d.querySelector(".woostify-preview-search-result"),k=d.querySelector(".woostify-preview-button");g&&(g.onclick=function(){h&&(0==e?(e=1,h.classList.add("active")):(e=0,h.classList.remove("active"))),i&&(i.focus(),i.oninput=function(){var a=i.value.trim();return a&&j?void woostifySearchDelay(function(){j&&(j.innerHTML="<span class=\"result-item\">"+woostify_woo_builder_editor.searching_text+"</span>");var b={action:"woo_builder_preview_search_data",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,keyword:a};b=new URLSearchParams(b).toString();var c=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:b,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(c).then(function(a){if(200!==a.status)throw console.log("Status Code: "+a.status),a;return a.json()}).then(function(a){!a.success||j&&(j.innerHTML=a.data.content)}).catch(function(a){console.log(a)}).finally(function(){var a=j?j.querySelectorAll(".result-item"):[];a.length&&a.forEach(function(a){a.onclick=function(){var b=a.getAttribute("data-url");if(b&&g){g.innerHTML=a.innerHTML,g.setAttribute("data-url",b);var c=a.getAttribute("data-id");c&&woostifySelectProductPreview(c),g.click()}}})})},500):void(j.innerHTML="")})}),k&&(k.onclick=function(){var a=g?g.getAttribute("data-url"):"";a=a?a:woostify_woo_builder_editor.preview_url,window.wooBuilderOpen&&window.wooBuilderOpen.parent?a===window.wooBuilderOpen.location.href?window.wooBuilderOpen.focus():window.wooBuilderOpen=window.open(a,"_blank"):window.wooBuilderOpen=window.open(a,"_blank")})}}}var g=a.querySelector("#elementor-panel-footer-sub-menu-item-save-template");if(g){g.insertAdjacentHTML("beforebegin","<div id=\"woostify-tool-display-conditions\" class=\"elementor-panel-footer-sub-menu-item\"><i class=\"elementor-icon eicon-flow\" aria-hidden=\"true\"></i><div class=\"elementor-title\">"+woostify_woo_builder_editor.condition_text+"</div></div>");var h=document.getElementById("elementor-preview"),i=a.querySelector("#woostify-tool-display-conditions"),j=document.getElementById("woostify-woobuilder-conditions-html");h&&j&&h.insertAdjacentHTML("afterend",j.innerHTML);var k=document.querySelector(".woostify-woobuilder-conditions");i&&k&&(i.onclick=function(a){a.preventDefault(),k.classList.add("active");var b=function(){k.classList.remove("active")};k.onclick=function(a){this!==a.target||b()};var c=k.querySelector(".woostify-woobuilder-conditions-close-btn");c&&(c.onclick=b),document.body.addEventListener("keyup",function(a){27!==a.keyCode||b()});var d=k.querySelector(".woostify-woobuilder-conditions-content-inner"),e=!!d&&d.querySelector(".woostify-woobuilder-condition-item-wrapper"),f=!!d&&d.querySelector(".woostify-condition-add-button"),g=function(){var a=document.querySelectorAll(".woostify-woobuilder-conditions .woostify-condition-item-remove");a.length&&a.forEach(function(a){a.onclick=function(){var b=a.parentNode;(b.nextElementSibling||b.previousElementSibling)&&b.remove()}})};if(g(),f){var h=f.getAttribute("data-type")||"";f.onclick=function(){var a=document.getElementById("woostify-woobuilder-conditions-"+h+"-html");a&&e&&e.insertAdjacentHTML("beforeend",a.innerHTML),g(),n()}}})}var l=document.getElementById("elementor-panel-saver-button-publish");if(l&&"publish"!=woostify_woo_builder_editor.post_status){l.insertAdjacentHTML("beforebegin","<button id=\"woostify-panel-saver-button-publish\" class=\"elementor-button elementor-button-success\">"+l.innerHTML+"</button>");var m=document.getElementById("woostify-panel-saver-button-publish");if(!m)return;m.onclick=function(){var a=this;if(!a.classList.contains("elementor-disabled")){var b=document.getElementById("woostify-tool-display-conditions");b&&b.click()}}}var n=function(){if(k){var a=k.querySelectorAll(".woostify-condition-item");a.length&&a.forEach(function(a){var b=a.querySelector(".woostify-condition-item-field"),c=a.querySelector(".woostify-condition-item-search-view");b&&(b.onchange=function(){["in-cat","in-tag"].includes(b.value)?a.classList.add("has-search-field"):(a.classList.remove("has-search-field"),c&&(c.setAttribute("data-id","all"),c.innerHTML=woostify_woo_builder_editor.all_text))});var d=a.querySelector(".woostify-condition-item-search");if(d){var f=d.querySelector(".woostify-condition-item-search-field"),g=0;d.onclick=function(a){var b=this,c=b.closest(".woostify-woobuilder-condition-item-wrapper"),e=c?c.querySelectorAll(".woostify-condition-item-search.active"):[];a.target===f||(e.length&&e.forEach(function(a){a!==b&&a.classList.remove("active")}),0==g?(b.classList.add("active"),g=1,f&&f.focus()):(g=0,b.classList.remove("active")),document.onclick=function(a){var c=a.target;c===b||c===f||(g=0,d.classList.remove("active"))})},f&&(f.oninput=function(){var a=d.querySelector(".woostify-condition-item-search-view"),c=f.value.trim(),e=d.querySelector(".woostify-condition-item-search-result");return c&&e?void woostifySearchDelay(function(){e&&(e.innerHTML="<span class=\"result-item\">"+woostify_woo_builder_editor.searching_text+"</span>");var d={action:"woo_builder_conditions_search_data",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,field_value:b.value,keyword:c};d=new URLSearchParams(d).toString();var f=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:d,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(f).then(function(a){if(200!==a.status)throw console.log("Status Code: "+a.status),a;return a.json()}).then(function(a){if(a.success){var b=a.data;e&&(e.innerHTML=b.content)}}).catch(function(a){console.log(a)}).finally(function(){var b=e?e.querySelectorAll(".result-item"):[];b.length&&b.forEach(function(b){b.onclick=function(){var c=b.getAttribute("data-id");c&&a&&(a.innerHTML=b.innerHTML,a.setAttribute("data-id",c))}})})},500):void(e.innerHTML="")})}})}};n();var o=function(){if(k){var a=k.querySelector(".save-options");a&&(a.onclick=function(){var a=k.querySelectorAll(".woostify-condition-item");if(a.length){NProgress.start(),k.click(),l&&l.classList.add("elementor-button-state");var b=document.getElementById("woostify-panel-saver-button-publish");b&&b.classList.add("disabled","elementor-button-state");var c=[];a.forEach(function(a){var b=a.querySelector(".woostify-condition-item-type"),d=a.querySelector(".woostify-condition-item-field"),e=a.querySelector(".woostify-condition-item-search-view"),f=e?e.getAttribute("data-id"):"all";b&&d&&c.push({data_type:b.value,data_field:d.value,data_id:f})});var d={action:"save_woo_builder_conditions",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,conditions:JSON.stringify(c)};d=new URLSearchParams(d).toString();var e=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:d,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(e).then(function(a){if(200!==a.status)throw console.log("Status Code: "+a.status),a;return a.json()}).then(function(a){!a.success}).catch(function(a){console.log(a)}).finally(function(){l&&(l.classList.remove("elementor-button-state"),l.click()),b&&b.classList.remove("elementor-button-state"),NProgress.done()})}})}};o(),elementor.saver.on("after:save",function(){window.wooBuilderOpen&&window.wooBuilderOpen.parent&&window.wooBuilderOpen.location.reload()})}};window.addEventListener("load",function(){woostifyWooBuilderPreview()});